

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Software Development Kit &mdash; Project 0.1.0-1ebd851 2017-08-11 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Project 0.1.0-1ebd851 2017-08-11 documentation" href="../../index.html"/>
        <link rel="prev" title="Continuous integration and deployment" href="../ci-and-cd/index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Project
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow/git-workflow.html">Git workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../baseplatform/index.html">Base Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci-and-cd/index.html">Continuous integration and deployment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Software Development Kit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#downloading-and-installing-the-sdk">Downloading and installing the SDK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-sdk">Installing the SDK</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-sdk-to-cross-compile">Using the SDK to cross compile</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sourcing-environment">Sourcing Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-compiling">Cross Compiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#template-service">Template Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compilation">Compilation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#source-code-repository-directory-structure">Source code repository directory structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mandatory-files">Mandatory files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#directory-naming">Directory naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-naming">File naming</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deploying-and-running-a-binary-executable-on-target">Deploying and running a binary executable on target</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Project</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Software Development Kit</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/chapters/sdk/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="software-development-kit">
<h1>Software Development Kit<a class="headerlink" href="#software-development-kit" title="Permalink to this headline">¶</a></h1>
<p>PELUX provides a Software Development Kit (SDK), for quick and easy development of software components for a PELUX (or PELUX-based) system. The SDK is mainly targeted towards service implementers but can be used for developing applications and other kinds of software components as well. The SDK installer script can be downloaded from <a class="reference external" href="http://pelux.io/downloads">PELUX website</a>. Each SDK installer is for a specific target hardware platform.</p>
<div class="section" id="downloading-and-installing-the-sdk">
<h2>Downloading and installing the SDK<a class="headerlink" href="#downloading-and-installing-the-sdk" title="Permalink to this headline">¶</a></h2>
<p>Download the SDK for your hardware from the <a class="reference external" href="http://pelux.io/downloads">PELUX website</a>. The SDK is a very huge file as it contains tho whole sysroot for the project in addition to some native tools. Depending on the internet connectivity speed it could take a while.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that the version number at the end of the SDK download file is not the version of the SDK but in fact the version number of poky, which is the upstream Yocto distribution PELUX is using.</p>
</div>
<div class="section" id="installing-the-sdk">
<span id="installing-sdk"></span><h3>Installing the SDK<a class="headerlink" href="#installing-the-sdk" title="Permalink to this headline">¶</a></h3>
<p>When the SDK has been downloaded from a HTTP server then per default is not executable. This needs to be changed with <cite>chmod</cite>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/Downloads
chmod +x poky-glibc-x86_64-core-image-pelux-qt-corei7-64-toolchain-2.2.1.sh
</pre></div>
</div>
<p>It is a self extracting shell script which can be executed. This will start an interactive program which first asks where to install the SDK. The easiest way is to install it in your <cite>home</cite> directory in it’s own directory, like <cite>~/sdk</cite>, instead of the default which is <cite>/opt</cite>. <cite>/opt</cite> is most probably not prepared for your user to install anything into.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>➜ jdoe@tux Downloads ./poky-glibc-x86_64-core-image-pelux-qt-corei7-64-toolchain-2.2.1.sh
Poky <span class="o">(</span>Yocto Project Reference Distro<span class="o">)</span> SDK installer version <span class="m">2</span>.2.1
<span class="o">=================================================================</span>
Enter target directory <span class="k">for</span> SDK <span class="o">(</span>default: /opt/poky/2.2.1<span class="o">)</span>: ~/sdk
You are about to install the SDK to <span class="s2">&quot;/home/jdoe/sdk&quot;</span>. Proceed<span class="o">[</span>Y/n<span class="o">]</span>? Y
Extracting SDK.............done
Setting it up...done
SDK has been successfully <span class="nb">set</span> up and is ready to be used.
</pre></div>
</div>
<p>Now the SDK is installed and can be used.</p>
</div>
</div>
<div class="section" id="using-the-sdk-to-cross-compile">
<h2>Using the SDK to cross compile<a class="headerlink" href="#using-the-sdk-to-cross-compile" title="Permalink to this headline">¶</a></h2>
<p>Cross compiling with the help of the SDK is not much different from normal compilation. There are some more pitfalls, but let’s get on with the happy cases for now.</p>
<div class="section" id="sourcing-environment">
<h3>Sourcing Environment<a class="headerlink" href="#sourcing-environment" title="Permalink to this headline">¶</a></h3>
<p>After the installation the SDK it needs to be sourced. This means that the SDK toolchain and the sysroot environment variables will be set in your active terminal session.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/sdk
<span class="nb">source</span> environment-setup-corei7-64-poky-linux
</pre></div>
</div>
<p>To check if the environment has already been sourced grep for variables which start with <cite>OECORE</cite> in the environment for example like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>env <span class="p">|</span> grep OECORE
<span class="nv">OECORE_DISTRO_VERSION</span><span class="o">=</span><span class="m">2</span>.2.1
<span class="nv">OECORE_SDK_VERSION</span><span class="o">=</span><span class="m">2</span>.2.1
</pre></div>
</div>
<p>This means that the environment has been sourced.</p>
</div>
<div class="section" id="cross-compiling">
<h3>Cross Compiling<a class="headerlink" href="#cross-compiling" title="Permalink to this headline">¶</a></h3>
<p>In the easiest case, when all the projects dependencies are already installed in the SDK, crosscompiling is really easy. Navigate in to the directory and use cmake and make to compile it as you normally would (see <a class="reference internal" href="template-service.html#template-service-compilation-label"><span class="std std-ref">Compilation</span></a>). The environment will make sure that the right compiler and cmake will be used.</p>
</div>
</div>
<div class="section" id="template-service">
<h2>Template Service<a class="headerlink" href="#template-service" title="Permalink to this headline">¶</a></h2>
<p>The template service serves as an example <a class="reference external" href="https://cmake.org/">CMake</a> project for service
developers that should be used as a starting point while creating platform
services, as well as as a set of guidelines to follow in source
repositories. The guidelines described are not set-in-stone. Also, in
general consistency is better than getting stuck on difficult-to-apply
guidelines so please use these to an extent which is reasonable. The point
is to support a common pattern within the project.</p>
<p>To acquire the template service source code the user needs to fetch the
code from github.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>git clone https://github.com/Pelagicore/template-service.git
</pre></div>
</div>
<div class="section" id="compilation">
<span id="template-service-compilation-label"></span><h3>Compilation<a class="headerlink" href="#compilation" title="Permalink to this headline">¶</a></h3>
<p>In order to compile the template service the user needs to use the CMake
build system. The CMake build system can be installed by following the
instructions on the <a class="reference external" href="https://cmake.org/install/">CMake install webpage</a> or by using your Linux
distribution’s package manager.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> template-service
mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
cmake .. <span class="o">&amp;&amp;</span> make -j4
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The example above presents how to compile the template service natively for your host machine.</p>
</div>
</div>
</div>
<div class="section" id="source-code-repository-directory-structure">
<h2>Source code repository directory structure<a class="headerlink" href="#source-code-repository-directory-structure" title="Permalink to this headline">¶</a></h2>
<p>In order to make it easier to navigate through new repositories they
should follow a common directory structure. The tree structure below
shows a repository with two components sharing a ‘doc’ directory and
‘component-test’ directory. Many repos will likely contain only one
component, in which case the structure should be the same but with only
one subdirectory with the source code etc.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>.
├── cmake_modules
├── component-A
│   ├── include
│   ├── src
│   ├── unit-test
│   │   ├── test-data
├── component-B
│   ├── include
│   ├── src
│   ├── unit-test
│   │   ├── test-data
├── component-test
│   ├── test-data
├── doc
│   ├── images
│   │   └── *.png
│   ├── design.md
│   ├── mainpage.h
├── scripts
├── DEPENDENCIES
├── LICENSE
└── README.md
</pre></div>
</div>
<p>The table below describes the directories and their purpose. The
&lt;component-subdir&gt; represents e.g. the ‘component-A’ or ‘component-B’
directories in the tree structure above. Some directories are only
relevant in some situations, e.g. a ‘test-data’ dir is only relevant
if there is any actual test data of course.</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Directory</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>scripts</td>
<td>Contains e.g. utility scripts that might be needed to e.g. set up an environment or such like.</td>
</tr>
<tr class="row-odd"><td>cmake_modules</td>
<td>Contains any CMake ‘find’ modules.</td>
</tr>
<tr class="row-even"><td>doc</td>
<td>Contains doxygen files for generating reference documentation that is not part of any class
etc, e.g. introductory pages and topic overviews. Contains design.md, describing the design
of the component in an arc42 structure.</td>
</tr>
<tr class="row-odd"><td>doc/images</td>
<td>Contains images for the design and doxygen documentation.
The preferred file format is png. If the image is generated from another document, it is
recommended to keep that document here as well, e.g. a UML model.</td>
</tr>
<tr class="row-even"><td>component-test</td>
<td>Contains tests and any stubs used in component tests.</td>
</tr>
<tr class="row-odd"><td>component-test/test-data</td>
<td>Contains any test data that the component tests uses.</td>
</tr>
<tr class="row-even"><td>&lt;component-subdir&gt;/include</td>
<td>Contains any public header files, those that would typically be installed in a development package.</td>
</tr>
<tr class="row-odd"><td>&lt;component-subdir&gt;/src</td>
<td>Contains source and private header files.</td>
</tr>
<tr class="row-even"><td>&lt;component-subdir&gt;/unit-test</td>
<td>Contains unit tests and any stubs used in unit tests.</td>
</tr>
<tr class="row-odd"><td>&lt;component-subdir&gt;/unit-test/test-data</td>
<td>Contains any test data that the unit tests uses.</td>
</tr>
</tbody>
</table>
<div class="section" id="mandatory-files">
<h3>Mandatory files<a class="headerlink" href="#mandatory-files" title="Permalink to this headline">¶</a></h3>
<p>Certain files should be found in every repository, those files are described below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>README(.md)</td>
<td>A top-level README giving a brief introduction to the repository.
How to build, how to run tests, other “good to know” information.
The .md suffix for markdown syntax may be used.</td>
</tr>
<tr class="row-odd"><td>LICENSE</td>
<td>The source code and project license.</td>
</tr>
<tr class="row-even"><td>DEPENDENCIES</td>
<td>Describes any non-trivial dependency used by a component.
Typically a library linked against such as libfoo would be listed while a compiler and libstdc++ would not be listed.</td>
</tr>
<tr class="row-odd"><td>CONTRIBUTING.md</td>
<td><dl class="first last docutils">
<dt>For OSS projects this file should exist and contain the following information:</dt>
<dd><ul class="first last simple">
<li>How and where to file bug reports and what information is expected in them.</li>
<li>How the development flow works, for instance forks and merge requests.</li>
<li>Brief about code standard</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td>doc/mainpage.h</td>
<td>Introductory component documentation.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="directory-naming">
<h3>Directory naming<a class="headerlink" href="#directory-naming" title="Permalink to this headline">¶</a></h3>
<p>All directories should be lower case only, and using “-” as a separator
between words. No other symbols other than [a..z], [0..9] and “-” are
allowed. Exceptions are allowed if there is a technical need which is
cumbersome to work around.</p>
</div>
<div class="section" id="file-naming">
<h3>File naming<a class="headerlink" href="#file-naming" title="Permalink to this headline">¶</a></h3>
<p>The source code and header files should be named using lower case letters
only, without any word separator. No other symbols other than [a..z] and
[0..9] are allowed. C++ source files should be suffixed “.cpp” and header
files “.h”. The exception is test code files where an underscore is used
to separate the name of what is tested and a suffix showing that it is a
test, e.g. a unit with the name ‘mymodule.cpp’/’mymodule.h’ would have a
corresponding unit test implemented in a file named
‘mymodule_unittest.cpp’.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The repository meta data files such as the readme, license and makefiles are allowed to use upper case letters in their naming.</p>
</div>
</div>
</div>
<div class="section" id="deploying-and-running-a-binary-executable-on-target">
<h2>Deploying and running a binary executable on target<a class="headerlink" href="#deploying-and-running-a-binary-executable-on-target" title="Permalink to this headline">¶</a></h2>
<p>Once the binary has been cross compiled, it needs to be installed on the target. To do so the easiest way is to use SSH. For that to work you need to know the IP address of your target.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference external" href="https://www.raspberrypi.org/documentation/remote-access/ip-address.md">Raspberry Pi documentation</a> describes how to find a new device on the network. Finding the IP address for our device will work in the same manner.</p>
</div>
<p>The default user on the PELUX image is <cite>root</cite> and it doesn’t ask for a password logging in via SSH. Use <cite>scp</cite> to copy your binary to the target.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>scp build/template-service root@&lt;ip address&gt;:
</pre></div>
</div>
<p>Now that the binary file has been copied to the target it can be run there.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ssh root@&lt;ip address&gt;
./template-service
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../ci-and-cd/index.html" class="btn btn-neutral" title="Continuous integration and deployment" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Pelagicore AB.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1.0-1ebd851 2017-08-11',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>